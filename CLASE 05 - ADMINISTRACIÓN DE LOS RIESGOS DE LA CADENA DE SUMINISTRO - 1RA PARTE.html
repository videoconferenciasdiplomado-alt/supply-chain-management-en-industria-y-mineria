<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title></title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet" />
    <style>
/* Estilos de balanceo de texto */
.header-content-box,
.header-compact-title,
.footer,
.section-title,
.subsection-title {
    text-wrap: balance;
}

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Inter", sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      :root {
        /* Colores Principales del Diseño (Acentos y Degradados) */
        /* ======================================================= */
        --color-principal: #00beff; /* Cian Brillante para acentos, bordes y el inicio del degradado principal */
        --color-secundario: #1e50cd; /* Azul Medio, parte final del degradado de acento */

        /* Fondos Oscuros de la Interfaz */
        /* ======================================================= */
        --fondo-oscuro-claro: #002a52; /* Fondo de secciones y contenido */
        --fondo-oscuro-fuerte: #001a33; /* Fondo del encabezado (header) y pie de página (footer) */
        /* ======================================================= */
        --fondo-oscuro-medio: #003366; /* Fondo de encabezados y cajas de contenido */
        --fondo-borde-claro: #004080; /* Bordes ligeros y color de fondo al hacer hover en encabezados */
        --fondo-sombra-azul-header: #0050a0; /* ¡NUEVO! Sombra en el header */

        /* Colores de Texto y Fondo General del Body */
        /* ======================================================= */
        --texto-blanco-1: #ffffff; /* Blanco puro para títulos y texto en fondo muy oscuro */
        --texto-claro-2: #e6e6e6; /* Texto principal y claro */
        --texto-medio-3: #cccccc; /* Texto de contenido de item (un poco más tenue) */

        /* ======================================================= */
        --fondo-body-inicio: #99e5ff; /* Color de inicio del degradado de fondo del body */
        --fondo-body-fin: #a5b9eb; /* Color de final del degradado de fondo del body */

        /* Colores de Acento Específicos (YouTube, Búsqueda) */
        /* ======================================================= */
        --rojo-youtube-claro: #e60000;
        --rojo-youtube-fuerte: #a30000;
        --timestamp-youtube: #ffcccc;
        --fondo-resaltado: #00c339; /* Verde para el fondo del texto buscado */

        /* Bases RGB para Transparencias (RGBA) */
        /* ======================================================= */
        --sombra-rgb: 0, 0, 0; /* Negro puro: Usado para sombras generales y profundidad */
        --acento-rgb: 0, 190, 255; /* Cian Brillante: Usado para brillos y sombras de acento */
        --rojo-rgb: 230, 0, 0; /* Rojo Puro: Usado para sombras de enlaces de YouTube */
        /* ======================================================= */
        --gradient-principal: linear-gradient(135deg, var(--color-principal) 0%, var(--color-secundario) 100%);
      }

      body {
        background: linear-gradient(135deg, var(--fondo-body-inicio) 0%, var(--fondo-body-fin) 100%);
        line-height: 1.2;
        scroll-behavior: smooth;
      }

      strong#tituloDiplomado {
        font-weight: 900;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
      }

      @keyframes slideDownSutil {
        0% {
          opacity: 0;
          transform: translateY(-10px);
        }
        100% {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .header.animacion-inicial {
        animation: slideDownSutil 0.4s ease-out 1;
        animation-fill-mode: forwards;
        will-change: transform, opacity;
      }

      .header {
        position: relative;
        width: 100%;
        z-index: 1000;
        padding: 20px;
        background: linear-gradient(135deg, var(--fondo-oscuro-fuerte) 0%, var(--fondo-oscuro-claro) 100%);
        box-shadow: 0 5px 15px rgba(var(--sombra-rgb), 0.5);
        text-align: center;
        will-change: transform;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .header-text-box {
        display: grid;
        gap: 10px;
        word-break: break-word;
        margin: 0 15px;
      }

      .header.compact {
        display: flex;
        flex-direction: column;
        align-items: center;
        position: fixed;
      }

      .header-spacer {
        display: none;
        transition: height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .header.compact + .header-spacer {
        display: block;
      }

      .header-top {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-wrap: wrap;
        gap: 10px;
      }

      .header.compact .header-top {
        display: none;
      }

      .logo {
        width: 140px;
        height: auto;
        margin: 0 15px;
        transition: all 0.3s ease;
        vertical-align: middle;
      }

      .header.compact .logo {
        width: 90px;
        margin: 0 10px;
      }

      .header .logo.compact-logo {
        display: none;
      }

      .header.compact .logo.compact-logo {
        display: block;
      }

      .header h1 {
        font-size: 2rem;
        color: var(--texto-blanco-1);
        font-weight: 900;
      }

      .header.compact h1 {
        font-size: 1rem;
      }

      .header p {
        font-size: 1.2rem;
        color: var(--texto-blanco-1);
        font-weight: 700;
      }

      .header-content-box {
        background: var(--gradient-principal);
        border-radius: 12px;
        padding: 20px 20px;
        box-shadow: 0 8px 20px rgba(var(--acento-rgb), 0.6);
        overflow: hidden;
        margin-bottom: 15px;

        opacity: 1;
        transform: translateY(0);
        will-change: transform;
        transition:
          opacity 0.4s ease,
          transform 0.4s ease;
      }

      .header.compact .header-content-box {
        opacity: 0;
        max-height: 0;
        padding-top: 0;
        padding-bottom: 0;
        margin-bottom: 0;
        border: 0;
        transform: translateY(-10px);
      }

      .header-content-box:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 30px rgba(var(--acento-rgb), 0.8);
      }

      .header-bottom-row {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        gap: 15px;
        flex-wrap: wrap;
        width: 100%;
      }

      .header-second-row {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 15px;
        flex-wrap: wrap;
        width: 100%;
      }

      .header.compact .header-bottom-row {
        flex-grow: 1;
      }

      .logo-and-title {
        opacity: 0;
        overflow: hidden;
        transform: translateY(-10px);
        transition:
          opacity 0.4s ease,
          transform 0.4s ease;
      }

      .header.compact .logo-and-title {
        opacity: 1;
        transform: translateY(0);
      }

      .header.compact .header-bottom-row .logo-and-title {
        will-change: transform;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-grow: 1;
        width: 100%;
        background: var(--gradient-principal);
        border-radius: 12px;
        padding: 10px;
        box-shadow: 0 4px 10px rgba(var(--acento-rgb), 0.4);
        gap: 10px;
      }

      .header.compact .header-bottom-row .logo-and-title:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 15px rgba(var(--acento-rgb), 0.5);
      }

      .header-compact-title {
        display: none;
        color: var(--texto-blanco-1);
        font-size: 1.2rem;
        font-weight: 700;
        margin: 10px;
        white-space: normal;
      }

      .header.compact .header-compact-title {
        display: block;
      }

      .search-bar {
        position: relative;
        display: flex;
        align-items: center;
        width: 100%;
        max-width: 450px;
        background-color: var(--fondo-oscuro-medio);
        border: 2px solid var(--fondo-borde-claro);
        border-radius: 30px;
        box-shadow: 0 4px 10px rgba(var(--sombra-rgb), 0.25);
        will-change: border-color, background-color;
        transition:
          border-color 0.3s ease,
          box-shadow 0.3s ease,
          background-color 0.3s ease;
      }

      .search-bar:focus-within {
        border-color: var(--fondo-sombra-azul-header);
        background-color: var(--fondo-borde-claro);
      }

      .clear-search {
        cursor: pointer;
        color: var(--texto-claro-2);
        padding: 5px;
        font-size: 1rem;
        font-weight: 400;
        line-height: 1;
        display: none;
        transition: color 0.2s ease;
        transform: scale(1.5);
      }

      .clear-search:hover {
        color: var(--texto-blanco-1);
      }

      .search-bar input {
        flex-grow: 1;
        padding: 10px 18px;
        font-weight: 400;
        font-size: 1rem;
        color: var(--texto-claro-2);
        background-color: transparent;
        border: none;
        outline: none;
        min-width: 0px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .header.compact .search-bar input {
        padding: 10px 20px;
      }

      .search-actions {
        display: flex;
        align-items: center;
      }

      .action-button {
        background: var(--gradient-principal);
        border: none;
        color: var(--texto-blanco-1);
        padding: 8px 18px;
        border-radius: 30px;
        cursor: pointer;
        font-size: 1rem;
        font-weight: 600;
        will-change: transform;
        transition: all 0.3s ease;
        box-shadow: 0 4px 10px rgba(var(--acento-rgb), 0.4);
        max-width: 150px;
        white-space: normal;
      }

      .action-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 15px rgba(var(--acento-rgb), 0.5);
      }

      .search-bar .action-button {
        margin: 5px;
      }

      .controls {
        display: flex;
        justify-content: center;
        gap: 15px;
      }

      @keyframes fadeInUpContent {
        0% {
          opacity: 0;
          transform: translateY(10px);
        }
        100% {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .mind-map {
        transition: margin-top 0.4s ease;
        margin: 50px 0;
      }

      .mind-map.animacion-contenido {
        animation: fadeInUpContent 0.4s ease-out 1 forwards;
        animation-delay: 0.2s;
        opacity: 0;
        will-change: opacity, transform;
      }

      .section {
        margin-bottom: 20px;
        background-color: var(--fondo-oscuro-claro);
        border-radius: 12px;
        border: 2px solid var(--fondo-oscuro-medio);
        overflow: hidden;
        box-shadow: 0 2px 10px rgba(var(--sombra-rgb), 0.25);
        transition: border-color 0.3s ease;
      }

      .section-header {
        padding: 20px;
        background-color: var(--fondo-oscuro-medio);
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
        will-change: background-color;
        transition:
          background-color 0.3s ease,
          color 0.3s ease;
      }

      .section-title {
        font-size: 1.4rem;
        font-weight: 700;
        color: var(--texto-claro-2);
        margin-right: 10px;
      }

      .section-number {
        background: var(--gradient-principal);
        color: var(--texto-blanco-1);
        padding: 5px 12px;
        border-radius: 30px;
        font-size: 15px;
        font-weight: 700;
        margin-right: 15px;
      }

      .toggle-icon {
        font-size: 1.2rem;
        color: var(--texto-claro-2);
        will-change: transform;
        transition: transform 0.3s ease;
      }

      .section.active > .section-header .toggle-icon {
        transform: rotate(180deg);
      }

      .section-content {
        max-height: 0;
        overflow: hidden;
        opacity: 0;
        transition:
          max-height 0.5s ease-out,
          opacity 0.3s ease-in;
      }

      .section.active .section-content {
        max-height: fit-content;
        padding-bottom: 10px;
        opacity: 1;
      }

      .subsection {
        margin: 15px;
        background-color: var(--fondo-oscuro-medio);
        border-radius: 12px;
        border: 2px solid var(--fondo-borde-claro);
        overflow: hidden;
        transition: border-color 0.3s ease;
      }

      .subsection:hover {
        border-color: var(--fondo-sombra-azul-header);
      }

      .subsection:hover .subsection-header {
        background-color: var(--fondo-sombra-azul-header);
      }

      .section:hover {
        border-color: var(--fondo-borde-claro);
      }

      .section:hover .section-header {
        background-color: var(--fondo-borde-claro);
      }

      .subsection-header {
        padding: 15px;
        background-color: var(--fondo-borde-claro);
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
        will-change: background-color;
        transition:
          background-color 0.3s ease,
          color 0.3s ease;
      }

      .subsection-title {
        font-size: 1.2rem;
        font-weight: 700;
        color: var(--texto-claro-2);
        margin-right: 10px;
      }

      .subsection-number {
        background: var(--gradient-principal);
        color: var(--texto-blanco-1);
        padding: 4px 10px;
        border-radius: 30px;
        font-size: 15px;
        font-weight: 700;
        margin-right: 12px;
      }

      .subsection-content {
        max-height: 0;
        overflow: hidden;
        background-color: var(--fondo-oscuro-claro);
        opacity: 0;
        transition:
          max-height 0.5s ease-out,
          opacity 0.3s ease-in;
      }

      .subsection.active .subsection-content {
        max-height: fit-content;
        padding: 15px;
        opacity: 1;
      }

      .subsection.active .toggle-icon {
        transform: rotate(180deg);
      }

      .content-item {
        margin-bottom: 10px;
        padding: 15px;
        background-color: var(--fondo-oscuro-medio);
        border-radius: 12px;
        border-left: 4px solid var(--color-principal);
        box-shadow: 0 1px 5px rgba(var(--sombra-rgb), 0.25);
      }

      .content-text {
        color: var(--texto-medio-3);
        margin-bottom: 5px;
        line-height: 1.4;
        font-size: 1rem;
        font-weight: 500;
        position: relative;
        padding-left: 15px;
      }

      .content-text::before {
        content: "•";
        color: var(--color-principal);
        font-weight: 700;
        display: inline-block;
        position: absolute;
        left: 0px;
      }

      .youtube-link {
        display: inline-block;
        padding: 10px 18px;
        background: linear-gradient(135deg, var(--rojo-youtube-claro) 0%, var(--rojo-youtube-fuerte) 100%);
        color: var(--texto-blanco-1);
        cursor: pointer;
        text-decoration: none;
        border-radius: 30px;
        font-size: 0.9rem;
        font-weight: 500;
        line-height: 1rem;
        transition: all 0.3s ease;
        margin-top: 10px;
        box-shadow: 0 2px 5px rgba(var(--rojo-rgb), 0.4);
        will-change: transform;
      }

      .youtube-link:hover {
        transform: translateY(-2px);
        box-shadow: 0 3px 7.5px rgba(var(--rojo-rgb), 0.5);
        will-change: transform;
      }

      .timestamp {
        color: var(--timestamp-youtube);
        font-size: 0.85rem;
        margin-left: 10px;
        font-weight: 400;
      }

      .highlight {
        background-color: var(--fondo-resaltado);
        color: var(--texto-blanco-1);
        font-weight: 700;
        padding: 4px;
        border-radius: 6px;
      }

      .footer {
        padding: 30px;
        background: linear-gradient(135deg, var(--fondo-oscuro-fuerte) 0%, var(--fondo-oscuro-claro) 100%);
        border-top: 1px solid var(--fondo-oscuro-medio);
        text-align: center;
        box-shadow: 0 -2px 10px rgba(var(--sombra-rgb), 0.25);
      }

      .footer-text {
        color: var(--texto-claro-2);
        font-size: 0.9rem;
        line-height: 1.6;
      }

      .footer-logo {
        width: 140px;
        height: auto;
        margin-bottom: 20px;
      }

      @media (max-width: 768px) {
        .header-top {
          flex-direction: column;
        }

        .logo {
          margin: 0;
        }

        .header-text-box {
          margin: 0;
        }

        .header h1 {
          font-size: 1.5rem;
        }

        .header p {
          font-size: 1rem;
        }

        .header.compact .header-bottom-row .logo-and-title {
          gap: 5px;
        }
        .logo,
        .footer-logo {
          width: 105px;
        }

        .header.compact .header-bottom-row {
          flex-direction: column;
        }

        .header.compact .header-compact-title {
          margin: 0 5px;
          font-size: 0.8rem;
        }

        .header.compact .logo.compact-logo {
          width: 65px;
          margin: 5px;
        }

        .action-button,
        .search-bar input,
        .clear-search {
          font-size: 0.9rem;
        }

        .section-header {
          padding: 15px;
        }

        .header.compact .controls {
          flex-direction: row;
        }

        .section-title {
          font-size: 1.1rem;
        }

        .subsection-title {
          font-size: 1rem;
        }
        .section-number,
        .subsection-number {
          font-size: 13px;
        }

        .content-text {
          font-size: 0.9rem;
        }

        .youtube-link {
          font-size: 0.8rem;
        }

        .timestamp {
          font-size: 0.75rem;
        }

        .header.compact .action-button {
          padding: 6px 18px;
        }
      }
    </style>
  </head>
  <body>
    <div class="header animacion-inicial">
      <div class="header-content-box">
        <div class="header-top">
          <a href="https://www.edumin.pe/" target="_blank">
            <img src="https://hebbkx1anhila5yf.public.blob.vercel-storage.com/LOGO%20BLANCO%20CANVA-mIKMypQ452RzmXVMUadb6mnvPaejXD.png" alt="EDUMIN Logo" class="logo" />
          </a>
          <div class="header-text-box">
            <h1>
              DIPLOMADO DE ALTA ESPECIALIZACIÓN EN<br />
              <strong id="tituloDiplomado"></strong>
            </h1>
            <p id="tituloPrincipal"></p>
          </div>
        </div>
      </div>

      <div class="header-bottom-row">
        <div class="logo-and-title">
          <a href="https://www.edumin.pe/" target="_blank">
            <img src="https://hebbkx1anhila5yf.public.blob.vercel-storage.com/LOGO%20BLANCO%20CANVA-mIKMypQ452RzmXVMUadb6mnvPaejXD.png" alt="EDUMIN Logo" class="logo compact-logo" />
          </a>
          <span class="header-compact-title" id="tituloCompacto"></span>
        </div>
        <div class="header-second-row">
          <div class="search-bar">
            <input type="text" id="searchInput" placeholder="Buscar en el resumen interactivo…" autocomplete="off" />
            <div class="search-actions">
              <span class="clear-search" onclick="clearSearch()">&times;</span>
              <button class="action-button" onclick="searchContent()">Buscar</button>
            </div>
          </div>

          <div class="controls">
            <button class="action-button" onclick="expandAll()">Mostrar todo</button>
            <button class="action-button" onclick="collapseAll()">Colapsar todo</button>
          </div>
        </div>
      </div>
    </div>

    <div class="header-spacer"></div>

    <div class="container">
      <div class="mind-map animacion-contenido" id="mindMap">
        <div class="section" data-section="1">
          <div class="section-header" onclick="toggleSection(this)">
            <div style="display: flex; align-items: center">
              <span class="section-number">1</span>
              <span class="section-title">Definición y contenido de la clase</span>
            </div>
            <span class="toggle-icon">▼</span>
          </div>
          <div class="section-content">
            <div class="subsection">
              <div class="subsection-header" onclick="toggleSubsection(this)">
                <div style="display: flex; align-items: center">
                  <span class="subsection-number">1.1</span>
                  <span class="subsection-title">Presentación del profesor Gonzalo González</span>
                </div>
                <span class="toggle-icon">▼</span>
              </div>
              <div class="subsection-content">
                <div class="content-item">
                  <div class="content-text">Formación y experiencia: Máster en Dirección de Operaciones y Logística. Más de 15 años de experiencia en compras estratégicas, análisis de datos, comercio internacional y gestión de proyectos.</div>
                  <div class="content-text">Trayectoria profesional: Lideró áreas logísticas en empresas mineras e industriales (Compañía de Minas Buenaventura, Fermín). Actualmente gerente de logística y almacenes en Tecnomin.</div>
                  <div class="content-text">Objetivo de la sesión: Introducir la temática: administración de riesgos en la cadena de suministro. Cobertura: definición, pasos para gestionar riesgos, casos prácticos, tecnologías y recomendaciones.</div>
                  <a href="https://www.youtube.com/watch?v=w2Q_aiJ9G_g&start=5" class="youtube-link" target="_blank"> Ver en YouTube <span class="timestamp">(00:00:05)</span> </a>
                </div>
              </div>
            </div>

            <div class="subsection">
              <div class="subsection-header" onclick="toggleSubsection(this)">
                <div style="display: flex; align-items: center">
                  <span class="subsection-number">1.2</span>
                  <span class="subsection-title">¿Qué es riesgo y gestión de riesgos en la cadena de suministro?</span>
                </div>
                <span class="toggle-icon">▼</span>
              </div>
              <div class="subsection-content">
                <div class="content-item">
                  <div class="content-text">Definición de riesgo en SCM: Suceso con efecto negativo cuantitativo o cualitativo sobre producción, transporte o entrega.</div>
                  <div class="content-text">Objetivo de la gestión de riesgos: Anticipar, identificar, evaluar y mitigar interrupciones en procesos logísticos.</div>
                  <div class="content-text">Estructura de la sesión: Temas a cubrir: definición, pasos de gestión, casos prácticos, tecnologías, recomendaciones.</div>
                  <a href="https://www.youtube.com/watch?v=w2Q_aiJ9G_g&start=150" class="youtube-link" target="_blank"> Ver en YouTube <span class="timestamp">(00:02:30)</span> </a>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="section" data-section="2">
          <div class="section-header" onclick="toggleSection(this)">
            <div style="display: flex; align-items: center">
              <span class="section-number">2</span>
              <span class="section-title">Identificación y valoración de riesgos</span>
            </div>
            <span class="toggle-icon">▼</span>
          </div>
          <div class="section-content">
            <div class="subsection">
              <div class="subsection-header" onclick="toggleSubsection(this)">
                <div style="display: flex; align-items: center">
                  <span class="subsection-number">2.1</span>
                  <span class="subsection-title">Identificación de riesgos</span>
                </div>
                <span class="toggle-icon">▼</span>
              </div>
              <div class="subsection-content">
                <div class="content-item">
                  <div class="content-text">Técnicas de identificación: Lluvia de ideas y análisis del flujo de procesos. Registro y descripción de cada riesgo (características, alcance).</div>
                  <div class="content-text">Enfoque práctico: Usar diagramas de flujo (p. ej., flujo de almacén) para localizar riesgos por proceso. Ejemplos prácticos mencionados durante la clase (documentación de proveedores, mercadería dañada, fallas de sistema).</div>
                  <a href="https://www.youtube.com/watch?v=w2Q_aiJ9G_g&start=383" class="youtube-link" target="_blank"> Ver en YouTube <span class="timestamp">(00:06:23)</span> </a>
                </div>
              </div>
            </div>

            <div class="subsection">
              <div class="subsection-header" onclick="toggleSubsection(this)">
                <div style="display: flex; align-items: center">
                  <span class="subsection-number">2.2</span>
                  <span class="subsection-title">Valoración de riesgos</span>
                </div>
                <span class="toggle-icon">▼</span>
              </div>
              <div class="subsection-content">
                <div class="content-item">
                  <div class="content-text">Componentes de la valoración (risk rating): Probabilidad: posibilidad de ocurrencia (escala 1-5). Gravedad: magnitud de la pérdida si ocurre (escala 1-5).</div>
                  <div class="content-text">Cálculo del impacto: Fórmula: impacto = probabilidad × gravedad. Interpretación: resultado entre 1 y 25 permite priorizar riesgos.</div>
                  <div class="content-text">Escalas y categorías: Gravedad 1-5 con definiciones (insignificante → catastrófico). Probabilidad 1-5 (muy improbable → muy probable). Clasificación por colores: bajo (1–6, verde), medio (7–12, naranja), alto (13–25, rojo).</div>
                  <a href="https://www.youtube.com/watch?v=w2Q_aiJ9G_g&start=885" class="youtube-link" target="_blank"> Ver en YouTube <span class="timestamp">(00:14:45)</span> </a>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="section" data-section="3">
          <div class="section-header" onclick="toggleSection(this)">
            <div style="display: flex; align-items: center">
              <span class="section-number">3</span>
              <span class="section-title">Tipos de riesgos y ejemplos</span>
            </div>
            <span class="toggle-icon">▼</span>
          </div>
          <div class="section-content">
            <div class="subsection">
              <div class="subsection-header" onclick="toggleSubsection(this)">
                <div style="display: flex; align-items: center">
                  <span class="subsection-number">3.1</span>
                  <span class="subsection-title">Tipos de riesgos en la cadena de suministro</span>
                </div>
                <span class="toggle-icon">▼</span>
              </div>
              <div class="subsection-content">
                <div class="content-item">
                  <div class="content-text">Riesgos relacionados con suministro/proveedores: Disponibilidad, calidad, plazos, robos, aduanas, interrupciones laborales.</div>
                  <div class="content-text">Riesgos en la demanda: Errores de pronóstico, variaciones de consumo (ejemplo: variación del tipo de roca en mina).</div>
                  <div class="content-text">Riesgos de procesos internos: Tecnología, seguridad informática, gestión de inventarios, capacidad, cobranzas, planeación.</div>
                  <div class="content-text">Riesgos del entorno y comerciales: Inestabilidad política/económica, infraestructura, desastres naturales, monopolios u oligopolios que condicionan condiciones comerciales.</div>
                  <a href="https://www.youtube.com/watch?v=w2Q_aiJ9G_g&start=505" class="youtube-link" target="_blank"> Ver en YouTube <span class="timestamp">(00:08:25)</span> </a>
                </div>
              </div>
            </div>

            <div class="subsection">
              <div class="subsection-header" onclick="toggleSubsection(this)">
                <div style="display: flex; align-items: center">
                  <span class="subsection-number">3.2</span>
                  <span class="subsection-title">Ejemplos y anécdotas</span>
                </div>
                <span class="toggle-icon">▼</span>
              </div>
              <div class="subsection-content">
                <div class="content-item">
                  <div class="content-text">Caso real de demanda en minería: Variación del tipo de roca redujo consumo de splitsets de 20.000 a 8.000 unidades mensuales, generando conflicto contractual con proveedor.</div>
                  <div class="content-text">Ejemplo de riesgo comercial con proveedor único de cemento: Proveedor exigía pago adelantado y condiciones que podían detener operaciones de la mina si no se cumplían.</div>
                  <a href="https://www.youtube.com/watch?v=w2Q_aiJ9G_g&start=542" class="youtube-link" target="_blank"> Ver en YouTube <span class="timestamp">(00:09:02)</span> </a>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="section" data-section="4">
          <div class="section-header" onclick="toggleSection(this)">
            <div style="display: flex; align-items: center">
              <span class="section-number">4</span>
              <span class="section-title">Caso práctico: evaluación de riesgos en un almacén</span>
            </div>
            <span class="toggle-icon">▼</span>
          </div>
          <div class="section-content">
            <div class="subsection">
              <div class="subsection-header" onclick="toggleSubsection(this)">
                <div style="display: flex; align-items: center">
                  <span class="subsection-number">4.1</span>
                  <span class="subsection-title">Caso práctico: evaluación de riesgos en un almacén</span>
                </div>
                <span class="toggle-icon">▼</span>
              </div>
              <div class="subsection-content">
                <div class="content-item">
                  <div class="content-text">Objetivo del caso: Identificar riesgos operativos del almacén, valorar gravedad y probabilidad, calcular impacto y elaborar plan de acción.</div>
                  <div class="content-text">Flujo simplificado del almacén usado como base: Etapas: entrega de repartidor → recepción → ingreso al sistema → almacenamiento → firma de orden de despacho.</div>
                  <div class="content-text">Riesgos identificados por proceso (muestras): Entrega: documentos equivocados o incompletos por parte del proveedor. Recepción: mercadería dañada.</div>
                  <div class="content-text">Ingreso al sistema: sistema no funciona; personal no capacitado. Almacenamiento: falta de espacio; equipos de manipulación averiados.</div>
                  <div class="content-text">Despacho: responsable para firma ausente.</div>
                  <a href="https://www.youtube.com/watch?v=w2Q_aiJ9G_g&start=1862" class="youtube-link" target="_blank"> Ver en YouTube <span class="timestamp">(00:31:02)</span> </a>
                </div>
              </div>
            </div>

            <div class="subsection">
              <div class="subsection-header" onclick="toggleSubsection(this)">
                <div style="display: flex; align-items: center">
                  <span class="subsection-number">4.2</span>
                  <span class="subsection-title">Valoración y matriz aplicada al caso</span>
                </div>
                <span class="toggle-icon">▼</span>
              </div>
              <div class="subsection-content">
                <div class="content-item">
                  <div class="content-text">Asignación de gravedad y probabilidad a cada riesgo: Ejemplos de puntuaciones y clasificación (p. ej., sistema no funciona: gravedad 4 × probabilidad 4 = 16 → alto).</div>
                  <div class="content-text">Construcción de la matriz 5×5 y mapeo de riesgos a colores: Uso de la matriz para priorizar recursos y definir acciones.</div>
                  <div class="content-text">Observaciones prácticas durante la actividad grupal: Doble coincidencia de riesgos en matriz cuando dos riesgos caen en la misma celda. Ordenamiento por mayor puntaje para priorizar medidas correctivas.</div>
                  <a href="https://www.youtube.com/watch?v=w2Q_aiJ9G_g&start=2172" class="youtube-link" target="_blank"> Ver en YouTube <span class="timestamp">(00:36:12)</span> </a>
                </div>
              </div>
            </div>

            <div class="subsection">
              <div class="subsection-header" onclick="toggleSubsection(this)">
                <div style="display: flex; align-items: center">
                  <span class="subsection-number">4.3</span>
                  <span class="subsection-title">Plan de acción del caso</span>
                </div>
                <span class="toggle-icon">▼</span>
              </div>
              <div class="subsection-content">
                <div class="content-item">
                  <div class="content-text">Ejemplos de actividades por riesgo: Comunicación masiva a proveedores para documentar correctamente entregas y carteles en entrada de almacén sobre documentación y condiciones de aceptación. Capacitación e inducción a proveedores y personal y procedimientos manuales temporales si falla el sistema y coordinación con TI. Mantenimiento preventivo y avisos a mantenimiento externo para equipos de manipulación.</div>
                  <div class="content-text">Gestión del plan: Responsable asignado, fecha objetivo, seguimiento de avance y observaciones en formato tipo Excel.</div>
                  <div class="content-text">Medidas concretas sugeridas en taller: Doble validación antes de emitir órdenes de compra como acción correctiva, responsable: analista de compras.</div>
                  <a href="https://www.youtube.com/watch?v=w2Q_aiJ9G_g&start=2553" class="youtube-link" target="_blank"> Ver en YouTube <span class="timestamp">(00:42:33)</span> </a>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="section" data-section="5">
          <div class="section-header" onclick="toggleSection(this)">
            <div style="display: flex; align-items: center">
              <span class="section-number">5</span>
              <span class="section-title">Pasos para gestionar riesgos</span>
            </div>
            <span class="toggle-icon">▼</span>
          </div>
          <div class="section-content">
            <div class="subsection">
              <div class="subsection-header" onclick="toggleSubsection(this)">
                <div style="display: flex; align-items: center">
                  <span class="subsection-number">5.1</span>
                  <span class="subsection-title">Valoración cuantitativa opcional</span>
                </div>
                <span class="toggle-icon">▼</span>
              </div>
              <div class="subsection-content">
                <div class="content-item">
                  <div class="content-text">Expected Monetary Value (EMV): Multiplicar probabilidad por costo monetario estimado del impacto.</div>
                  <div class="content-text">Limitaciones y consideraciones: Dificultad para cuantificar pérdidas intangibles (lucro cesante, reputación). Recomendación del profesor: usar probabilidades si no se puede costear con precisión.</div>
                  <a href="https://www.youtube.com/watch?v=w2Q_aiJ9G_g&start=1708" class="youtube-link" target="_blank"> Ver en YouTube <span class="timestamp">(00:28:28)</span> </a>
                </div>
              </div>
            </div>

            <div class="subsection">
              <div class="subsection-header" onclick="toggleSubsection(this)">
                <div style="display: flex; align-items: center">
                  <span class="subsection-number">5.2</span>
                  <span class="subsection-title">Creación y ejecución del plan de acción</span>
                </div>
                <span class="toggle-icon">▼</span>
              </div>
              <div class="subsection-content">
                <div class="content-item">
                  <div class="content-text">Componentes del plan de acción: Acciones concretas, calendario, aprobaciones, presupuesto y recursos. Responsables por tareas, tiempos de recuperación y procesos alternativos.</div>
                  <div class="content-text">Mantenimiento del plan: Actualización periódica (cada 2-3 años). Comité de riesgos, políticas y procedimientos para continuidad operativa.</div>
                  <a href="https://www.youtube.com/watch?v=w2Q_aiJ9G_g&start=1801" class="youtube-link" target="_blank"> Ver en YouTube <span class="timestamp">(00:30:01)</span> </a>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="section" data-section="6">
          <div class="section-header" onclick="toggleSection(this)">
            <div style="display: flex; align-items: center">
              <span class="section-number">6</span>
              <span class="section-title">Dinámica de clase y recursos</span>
            </div>
            <span class="toggle-icon">▼</span>
          </div>
          <div class="section-content">
            <div class="subsection">
              <div class="subsection-header" onclick="toggleSubsection(this)">
                <div style="display: flex; align-items: center">
                  <span class="subsection-number">6.1</span>
                  <span class="subsection-title">Actividad en grupo y materiales</span>
                </div>
                <span class="toggle-icon">▼</span>
              </div>
              <div class="subsection-content">
                <div class="content-item">
                  <div class="content-text">Trabajo práctico en grupos: Cada grupo debe identificar tres riesgos por proceso en un flujo de compras simple (5 pasos), valorar y elaborar matriz y plan.</div>
                  <div class="content-text">Entrega de plantilla y recursos: Profesor comparte plantilla Excel por correo; se indica cómo solicitarla si no está disponible en aula virtual.</div>
                  <div class="content-text">Logística de la sesión: Pausa de cinco minutos antes de iniciar trabajo en grupo; captura de pantalla de materiales para referencia.</div>
                  <a href="https://www.youtube.com/watch?v=w2Q_aiJ9G_g&start=2821" class="youtube-link" target="_blank"> Ver en YouTube <span class="timestamp">(00:47:01)</span> </a>
                </div>
              </div>
            </div>

            <div class="subsection">
              <div class="subsection-header" onclick="toggleSubsection(this)">
                <div style="display: flex; align-items: center">
                  <span class="subsection-number">6.2</span>
                  <span class="subsection-title">Interacción y preguntas</span>
                </div>
                <span class="toggle-icon">▼</span>
              </div>
              <div class="subsection-content">
                <div class="content-item">
                  <div class="content-text">Invitación a la participación: Preguntas sobre términos específicos (ej.: materiales de sostenimiento como splitsets, mallas, cimbras).</div>
                  <div class="content-text">Disponibilidad del profesor: Responde dudas de logística adicionales y ofrece apoyo práctico (ej.: revisión de currículum para quienes buscan insertarse en logística).</div>
                  <a href="https://www.youtube.com/watch?v=w2Q_aiJ9G_g&start=718" class="youtube-link" target="_blank"> Ver en YouTube <span class="timestamp">(00:11:58)</span> </a>
                </div>
              </div>
            </div>

            <div class="subsection">
              <div class="subsection-header" onclick="toggleSubsection(this)">
                <div style="display: flex; align-items: center">
                  <span class="subsection-number">6.3</span>
                  <span class="subsection-title">Cierre y seguimiento</span>
                </div>
                <span class="toggle-icon">▼</span>
              </div>
              <div class="subsection-content">
                <div class="content-item">
                  <div class="content-text">Envío de material y registro de asistencia: Profesor reitera que enviará plantilla y link para registrar asistencia por correo.</div>
                  <div class="content-text">Organización de grupos y reparto de tareas: Solicitud de correos de estudiantes para compartir archivos y coordinación de trabajo en grupo.</div>
                  <a href="https://www.youtube.com/watch?v=w2Q_aiJ9G_g&start=3590" class="youtube-link" target="_blank"> Ver en YouTube <span class="timestamp">(00:59:50)</span> </a>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="section" data-section="7">
          <div class="section-header" onclick="toggleSection(this)">
            <div style="display: flex; align-items: center">
              <span class="section-number">7</span>
              <span class="section-title">Sesión práctica: trabajo en grupos y presentación de avances</span>
            </div>
            <span class="toggle-icon">▼</span>
          </div>
          <div class="section-content">
            <div class="subsection">
              <div class="subsection-header" onclick="toggleSubsection(this)">
                <div style="display: flex; align-items: center">
                  <span class="subsection-number">7.1</span>
                  <span class="subsection-title">Organización de la dinámica y soporte</span>
                </div>
                <span class="toggle-icon">▼</span>
              </div>
              <div class="subsection-content">
                <div class="content-item">
                  <div class="content-text">Envío y verificación de materiales: Profesor comparte matriz y plantilla; corrige envíos incompletos y reenvía cuando falta contenido. Comunicación por grupo de WhatsApp para compartir archivos.</div>
                  <div class="content-text">Formación y gestión de grupos: División en dos salas/grupos; captura de pantalla para registro de participantes. Indicaciones para ingresar a las salas y tiempo asignado (~40 minutos).</div>
                  <a href="https://www.youtube.com/watch?v=w2Q_aiJ9G_g&start=3610" class="youtube-link" target="_blank"> Ver en YouTube <span class="timestamp">(01:00:10)</span> </a>
                </div>
              </div>
            </div>

            <div class="subsection">
              <div class="subsection-header" onclick="toggleSubsection(this)">
                <div style="display: flex; align-items: center">
                  <span class="subsection-number">7.2</span>
                  <span class="subsection-title">Desarrollo del trabajo en aula</span>
                </div>
                <span class="toggle-icon">▼</span>
              </div>
              <div class="subsection-content">
                <div class="content-item">
                  <div class="content-text">Progreso y exposición de grupos: Primer grupo presentó identificación de riesgos desde requerimiento hasta seguimiento, con ejemplos concretos por etapa. Segundo grupo presentó riesgos por proceso de forma sintética, priorizando error en la orden de compra y retrasos en entrega.</div>
                  <div class="content-text">Riesgos identificados en un flujo de compras (ejemplos desarrollados): Requerimiento: solicitudes no específicas o incompletas por falta de datos técnicos o mal direccionamiento. Cotización: respuestas tardías, cotizaciones no detalladas (moneda, cantidades) o sesgo en evaluaciones. Evaluación y selección: ausencia de procedimiento, preferencia por dádivas, inexperiencia al evaluar. Emisión de órdenes de compra: errores en consignación de datos, falta de ERP o fallas del sistema. Seguimiento: retrasos en entrega y recepción de bienes fuera de especificación.</div>
                  <a href="https://www.youtube.com/watch?v=w2Q_aiJ9G_g&start=6783" class="youtube-link" target="_blank"> Ver en YouTube <span class="timestamp">(01:53:03)</span> </a>
                </div>
              </div>
            </div>

            <div class="subsection">
              <div class="subsection-header" onclick="toggleSubsection(this)">
                <div style="display: flex; align-items: center">
                  <span class="subsection-number">7.3</span>
                  <span class="subsection-title">Valoración práctica y plan parcial</span>
                </div>
                <span class="toggle-icon">▼</span>
              </div>
              <div class="subsection-content">
                <div class="content-item">
                  <div class="content-text">Aplicación de escalas y priorización: Asignación de gravedad y probabilidad a riesgos identificados; mapeo a colores para priorizar acciones.</div>
                  <div class="content-text">Elaboración inicial de actividades: Inicio de acciones de mitigación vinculadas a riesgos críticos, con responsables y propuestas de seguimiento.</div>
                  <div class="content-text">Observación docente: buen inicio, continuará revisión en próximas clases y se completará la matriz y actividades.</div>
                  <a href="https://www.youtube.com/watch?v=w2Q_aiJ9G_g&start=7028" class="youtube-link" target="_blank"> Ver en YouTube <span class="timestamp">(01:57:08)</span> </a>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="section" data-section="8">
          <div class="section-header" onclick="toggleSection(this)">
            <div style="display: flex; align-items: center">
              <span class="section-number">8</span>
              <span class="section-title">Interacción final y logística de cierre de la actividad</span>
            </div>
            <span class="toggle-icon">▼</span>
          </div>
          <div class="section-content">
            <div class="subsection">
              <div class="subsection-header" onclick="toggleSubsection(this)">
                <div style="display: flex; align-items: center">
                  <span class="subsection-number">8.1</span>
                  <span class="subsection-title">Gestión del tiempo y retorno a sesión plenaria</span>
                </div>
                <span class="toggle-icon">▼</span>
              </div>
              <div class="subsection-content">
                <div class="content-item">
                  <div class="content-text">Control del tiempo.</div>
                  <div class="content-text">Profesor avisó cierre próximo, solicitó que todos regresen a la sala principal para exponer.</div>
                  <div class="content-text">Retroalimentación y siguientes pasos.</div>
                  <div class="content-text">Revisión por grupos, comentarios sobre profundidad del análisis y sugerencias para completar plan de acción en próximas sesiones.</div>
                  <a href="https://www.youtube.com/watch?v=w2Q_aiJ9G_g&start=6724" class="youtube-link" target="_blank"> Ver en YouTube <span class="timestamp">(01:52:04)</span> </a>
                </div>
              </div>
            </div>

            <div class="subsection">
              <div class="subsection-header" onclick="toggleSubsection(this)">
                <div style="display: flex; align-items: center">
                  <span class="subsection-number">8.2</span>
                  <span class="subsection-title">Despedida y agradecimientos</span>
                </div>
                <span class="toggle-icon">▼</span>
              </div>
              <div class="subsection-content">
                <div class="content-item">
                  <div class="content-text">Profesor agradece participación, invita a consultas en la siguiente clase y recuerda disponibilidad previa al inicio de la sesión para resolver dudas menores.</div>
                  <div class="content-text">Mensaje final sobre la sesión: buenos deseos y cierre formal de la clase.</div>
                  <a href="https://www.youtube.com/watch?v=w2Q_aiJ9G_g&start=7595" class="youtube-link" target="_blank"> Ver en YouTube <span class="timestamp">(02:06:35)</span> </a>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="section" data-section="9">
          <div class="section-header" onclick="toggleSection(this)">
            <div style="display: flex; align-items: center">
              <span class="section-number">9</span>
              <span class="section-title">Preguntas y respuestas destacadas durante cierre</span>
            </div>
            <span class="toggle-icon">▼</span>
          </div>
          <div class="section-content">
            <div class="subsection">
              <div class="subsection-header" onclick="toggleSubsection(this)">
                <div style="display: flex; align-items: center">
                  <span class="subsection-number">9.1</span>
                  <span class="subsection-title">Preguntas y respuestas destacadas durante cierre</span>
                </div>
                <span class="toggle-icon">▼</span>
              </div>
              <div class="subsection-content">
                <div class="content-item">
                  <div class="content-text">Relación con matrices de seguridad: metodología 5×5 es estándar y se usa en seguridad industrial.</div>
                  <div class="content-text">Determinación de probabilidad: proceso subjetivo basado en experiencia, con posibilidad de métodos comparativos más técnicos.</div>
                  <div class="content-text">Aplicación de la matriz a producción y materiales: se puede aplicar por flujo productivo o por familias de material usando un pareto para priorizar categorías (A/B/C).</div>
                  <div class="content-text">Recomendación docente: usar pareto por familias para no evaluar cada artículo individualmente y clasificar criticidad.</div>
                  <a href="https://www.youtube.com/watch?v=w2Q_aiJ9G_g&start=7210" class="youtube-link" target="_blank"> Ver en YouTube <span class="timestamp">(02:00:10)</span> </a>
                </div>
              </div>
            </div>

            <div class="subsection">
              <div class="subsection-header" onclick="toggleSubsection(this)">
                <div style="display: flex; align-items: center">
                  <span class="subsection-number">9.2</span>
                  <span class="subsection-title">Información logística final de la sesión</span>
                </div>
                <span class="toggle-icon">▼</span>
              </div>
              <div class="subsection-content">
                <div class="content-item">
                  <div class="content-text">En breve se enviará el link para ver la grabación de la clase.</div>
                  <div class="content-text">Próxima sesión programada: viernes 29, mismo horario; se recomienda conectarse antes.</div>
                  <div class="content-text">Números de atención y correo electrónico en pantalla para coordinación académica y atención a diplomados (horario de atención: lunes a viernes 08:00–18:30).</div>
                  <a href="https://www.youtube.com/watch?v=w2Q_aiJ9G_g&start=7622" class="youtube-link" target="_blank"> Ver en YouTube <span class="timestamp">(02:07:02)</span> </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="footer">
      <a href="https://www.edumin.pe/" target="_blank">
        <img src="https://hebbkx1anhila5yf.public.blob.vercel-storage.com/LOGO%20BLANCO%20CANVA-mIKMypQ452RzmXVMUadb6mnvPaejXD.png" alt="EDUMIN Logo" class="footer-logo" />
      </a>
      <p class="footer-text">
        <b>Contenido desarrollado por EDUMIN - Centro de Capacitación Especializado en Minería, Industria y Negocios</b><br />
        <i>Material exclusivo para estudiantes de EDUMIN</i><br />
        <a href="https://www.edumin.pe/" target="_blank" style="color: var(--color-principal); text-decoration: none">https://www.edumin.pe/</a>
      </p>
    </div>

    <script>
      let originalTextMap = {};

      const TITULO_DIPLOMADO = "SUPPLY CHAIN MANAGEMENT EN INDUSTRIA Y MINERÍA".toUpperCase();
      const TITULO_CLASE = "CLASE 05: ADMINISTRACIÓN DE LOS RIESGOS DE LA CADENA DE SUMINISTRO - 1RA PARTE".toUpperCase();

      const elementoDiplomado = document.getElementById("tituloDiplomado");
      if (elementoDiplomado) {
        elementoDiplomado.innerText = TITULO_DIPLOMADO;
      }

      document.title = TITULO_CLASE;
      const tituloPrincipal = document.getElementById("tituloPrincipal");
      if (tituloPrincipal) {
        tituloPrincipal.innerText = TITULO_CLASE;
      }

      const tituloCompacto = document.getElementById("tituloCompacto");
      if (tituloCompacto) {
        tituloCompacto.innerText = TITULO_CLASE;
      }

      function cacheOriginalTexts() {
        const searchableItems = document.querySelectorAll(".section-title, .subsection-title, .content-text");

        let idCounter = 0;

        searchableItems.forEach((item) => {
          if (!item.id) {
            item.id = `search-item-${idCounter++}`;
          }

          originalTextMap[item.id] = item.textContent.trim();
        });
      }

      document.addEventListener("DOMContentLoaded", cacheOriginalTexts);

      function toggleSection(element) {
        const section = element.closest(".section");
        const wasActive = section.classList.contains("active");

        section.classList.toggle("active");

        if (wasActive) {
          const subsections = section.querySelectorAll(".subsection");
          subsections.forEach((subsection) => {
            subsection.classList.remove("active");
          });
        }
      }

      function toggleSubsection(element) {
        const subsection = element.closest(".subsection");
        subsection.classList.toggle("active");
      }

      function expandAll() {
        const sections = document.querySelectorAll(".section");
        sections.forEach((section) => {
          section.classList.add("active");
        });

        const subsections = document.querySelectorAll(".subsection");
        subsections.forEach((subsection) => {
          subsection.classList.add("active");
        });
      }

      function collapseAll() {
        const sections = document.querySelectorAll(".section");
        sections.forEach((section) => {
          section.classList.remove("active");
        });

        const subsections = document.querySelectorAll(".subsection");
        subsections.forEach((subsection) => {
          subsection.classList.remove("active");
        });
      }

      function debounce(func, delay) {
        let timeout;
        return function (...args) {
          const later = () => {
            clearTimeout(timeout);
            func.apply(this, args);
          };
          clearTimeout(timeout);
          timeout = setTimeout(later, delay);
        };
      }

      function clearSearch() {
        const searchInput = document.getElementById("searchInput");
        const clearBtn = document.querySelector(".search-actions .clear-search");
        searchInput.value = "";
        clearBtn.style.display = "none";
        searchContent();
        searchInput.focus();
      }

      const createDiacriticInsensitiveRegex = (term) => {
        const charMap = {
          a: "[aáAÁ]",
          e: "[eéEÉ]",
          i: "[iíIÍ]",
          o: "[oóOÓ]",
          u: "[uúUÚ]",
        };

        const regexString = term
          .split("")
          .map((char) => {
            const lowerChar = char.toLowerCase();
            return charMap[lowerChar] || char;
          })
          .join("");

        return new RegExp(`(${regexString})`, "gi");
      };
      function searchContent() {
        const inputElement = document.getElementById("searchInput");
        const searchTerm = inputElement.value.trim();

        const searchableElements = document.querySelectorAll(".content-text, .section-title, .subsection-title");
        let found = false;
        let firstMatchElement = null;

        // 1. Limpia clases 'active'
        document.querySelectorAll(".section.active").forEach((el) => el.classList.remove("active"));
        document.querySelectorAll(".subsection.active").forEach((el) => el.classList.remove("active"));

        // 2. RESTAURACIÓN DEL CONTENIDO (CORRECCIÓN CLAVE 1)
        // Se usa el mapa en memoria para restaurar el HTML de los elementos
        searchableElements.forEach((element) => {
          // Usamos el ID del elemento para buscar el texto original en la memoria
          element.innerHTML = originalTextMap[element.id] || element.textContent;
        });

        if (searchTerm.length < 3) {
          // Si el término es muy corto, restauramos y salimos
          return;
        }

        const searchRegex = createDiacriticInsensitiveRegex(searchTerm);

        searchableElements.forEach((element) => {
          // 3. OBTENCIÓN DEL TEXTO PARA BÚSQUEDA (CORRECCIÓN CLAVE 2)
          // Usamos la variable de bucle 'element' para obtener el ID
          const originalText = originalTextMap[element.id] || element.textContent; // ¡Corregido de 'item.id' a 'element.id'!

          if (searchRegex.test(originalText)) {
            found = true;

            // Resaltado
            element.innerHTML = originalText.replace(searchRegex, `<span class="highlight">$1</span>`);

            // Activación de secciones y subsecciones
            const subsection = element.closest(".subsection");
            if (subsection) {
              subsection.classList.add("active");
              subsection.closest(".section")?.classList.add("active");
            } else if (element.classList.contains("section-title")) {
              element.closest(".section")?.classList.add("active");
            }

            if (!firstMatchElement) {
              firstMatchElement = element;
            }
          }
        });

        // Lógica de desplazamiento
        if (firstMatchElement) {
          requestAnimationFrame(() => {
            firstMatchElement.scrollIntoView({
              behavior: "smooth",
              block: "center",
            });
          });
        } else if (searchTerm.length >= 3) {
          alert("No se encontraron resultados para: " + searchTerm);
        }
      }

      const debouncedSearch = debounce(searchContent, 300);

      document.getElementById("searchInput").addEventListener("input", function () {
        const clearBtn = document.querySelector(".search-actions .clear-search");
        clearBtn.style.display = this.value.length > 0 ? "block" : "none";
        debouncedSearch();
      });

      document.getElementById("searchInput").addEventListener("keypress", function (e) {
        if (e.key === "Enter") {
          clearTimeout(this._timeoutId);
          searchContent();
        }
      });

      // --- Lógica del Header Compacto ---
      const header = document.querySelector(".header");
      const headerSpacer = document.querySelector(".header-spacer");
      let initialHeaderHeight = 0; // Altura del header original
      let compactHeaderHeight = 0; // Altura del header en modo compacto
      let scrollTriggerPoint = 0; // Punto de scroll para activar el cambio

      function handleHeaderState() {
        const scrollY = window.scrollY || document.documentElement.scrollTop;

        if (scrollY > scrollTriggerPoint) {
          if (!header.classList.contains("compact")) {
            header.classList.add("compact");
            headerSpacer.style.height = `${initialHeaderHeight}px`;
          }
        } else {
          if (header.classList.contains("compact")) {
            header.classList.remove("compact");
            headerSpacer.style.height = "0px";
          }
        }
      }

      function initializeHeader() {
        initialHeaderHeight = header.offsetHeight;
        const headerClone = header.cloneNode(true);
        headerClone.classList.add("compact");
        headerClone.style.visibility = "hidden";
        headerClone.style.position = "absolute";
        document.body.appendChild(headerClone);
        compactHeaderHeight = headerClone.offsetHeight;
        document.body.removeChild(headerClone);

        scrollTriggerPoint = initialHeaderHeight - compactHeaderHeight;
      }

      document.addEventListener("DOMContentLoaded", initializeHeader);
      window.addEventListener("scroll", handleHeaderState);
      window.addEventListener("resize", debounce(initializeHeader, 200));
    </script>
  </body>
</html>
